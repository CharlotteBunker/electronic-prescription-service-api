type: object
description: The prescription order to be encoded for signing, expressed as a FHIR message 'bundle'.
required:
  - resourceType
  - identifier
  - type
  - entry
properties:
  resourceType:
    type: string
    description: The FHIR resource type for the prescription order bundle.
    enum:
      - Bundle
  id:
    type: string
    description: "A logical identifier for the prescription order bundle. Optional, and ignored by us."
    example: "aef77afb-7e3c-427a-8657-2c427f71a271"
  identifier:
    type: object
    description: "A unique identifier for the prescription order, expressed as a UUID. Used by us to reference the prescription order in various places."
    properties:
      system:
        type: string
        description: "A URL that describes the system or rules used to define the identifier, for example UUID as defined in RFC 4122."
        example: "https://tools.ietf.org/html/rfc4122"
      value:
        type: string
        description: "The identifier itself, generated by you."
        example: "f442b1a3-efe2-4434-b9cf-888e2f12d0a5"
  type:
    type: string
    description: The FHIR bundle type - in this case, a message.
    enum:
      - message
  entry:
    type: array
    description: "The details of the prescription order."
    items:
      oneOf:
        - type: object
          description: "The message header. There must be exactly one of these and it must be first in the array."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:aef77afb-7e3c-427a-8657-2c427f71a271"
            resource:
              type: object
              description: "The FHIR resource for the message header."
              required:
                - ResourceType
                - eventCoding
                - source
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the message header."
                  enum:
                    - MessageHeader
                id:
                  type: string
                  description: "A logical identifier for the message header. Optional, and ignored by us."
                  example: "3599c0e9-9292-413e-9270-9a1ef1ead99c"
                eventCoding:
                  type: object
                  description: "The type of event being described in the FHIR message - in this case, a prescription order."
                  required:
                    - system
                    - code
                  properties:
                    system:
                      type: string
                      description: "The code system for the event type."
                      enum:
                        - "https://fhir.nhs.uk/CodeSystem/message-event"
                    code:
                      type: string
                      description: "The actual code for the event type."
                      enum:
                        - "prescription-order"
                    display:
                      type: string
                      description: "A human-readable description of the event type."
                      enum:
                        - "Prescription Order"
                sender:
                  type: object
                  description: "Details of the sender of the message. Optional, and ignored by us."
                  required:
                    - identifier
                  properties:
                    identifier:
                      type: object
                      description: "A unique identifier for the sender."
                      required:
                        - system
                        - value
                      properties:
                        system:
                          type: string
                          description: "A URL that describes the system or rules used to define the identifier, for example ODS organisation code."
                          example: "https://fhir.nhs.uk/Id/ods-organization-code"
                        value:
                          type: string
                          description: "The identifier itself."
                          example: "RBA"
                    reference:
                      type: string
                      description: "A URL that is a literal reference to the sender."
                      example: "urn:uuid:56166769-c1c4-4d07-afa8-132b5dfca666"
                    display:
                      type: string
                      description: "A human-readable description of the sender."
                      example: "RAZIA|ALI"
                source:
                  type: object
                  description: "Details of the application that is the source of the message. Mandatory, but ignored by us."
                  required:
                    - endpoint
                  properties:
                    endpoint:
                      type: string
                      description: "URL for the source application."
                      example: "urn:nhs-uk:addressing:ods:RBA"
                destination:
                  type: array
                  description: "A list of destinations for the message. Optional, and ignored by us."
                  items:
                    type: object
                    description: "A destination for the message."
                    required:
                      - endpoint
                      - receiver
                    properties:
                      endpoint:
                        type: string
                        description: "Actual destination address or ID."
                        example: "urn:nhs-uk:addressing:ods:FH542"
                      receiver:
                        type: object
                        description: "Intender 'real-world' recipient for the message."
                        required:
                          - identifier
                        properties:
                          identifier:
                            type: object
                            description: "Unique identifier for the receiver."
                            required:
                              - system
                              - value
                            properties:
                              system:
                                type: string
                                description: "A URL that describes the system or rules used to define the identifier, for example ODS organisation code."
                                example: "https://fhir.nhs.uk/Id/ods-organization-code"
                              value:
                                type: string
                                description: "The identifier itself."
                                example: "FH542"
                focus:
                  type: array
                  description: "A list of references to the content of the FHIR message i.e the other FHIR resources in the 'items' array. Optional, but if supplied, it must exactly match the other FHIR resources in the array."
                  items:
                    type: object
                    description: "A reference to one of the other FHIR resources in the 'items' array."
                    required:
                      - reference
                    properties:
                      reference:
                        type: string
                        description: "The identifier for the FHIR resource being referenced, prefixed with `urn:uuid`."
                        example: "urn:uuid:78d3c2eb-009e-4ec8-a358-b042954aa9b2"
        - type: object
          description: "A medication being requested. There must be between one and four of these."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:a54219b8-f741-4c47-b662-e4f8dfa49ab6"
            resource:
              type: object
              description: "The FHIR resource for the medication request."
              required:
                - ResourceType
                - extension
                - identifier
                - status
                - intent
                - category
                - medicationCodeableConcept
                - subject
                - authoredOn
                - requestor
                - groupIdentifier
                - courseOfTherapyType
                - dosageInstruction
                - dispenseRequest
                - substitution
              properties:
                ResourceType:
                  type: string
                  description: The FHIR resource type for the medication request.
                  enum:
                    - MedicationRequest
                id:
                  type: string
                  description: "A logical identifier for the medication request. Optional, and ignored by us."
                  example: "a54219b8-f741-4c47-b662-e4f8dfa49ab6"
                extension:
                  type: array
                  description: "TBC."
                  items:
                    oneOf:
                      - type: object
                        description: "TBC medication repeat information - 0..1."
#                        required:
#                          - TBC
                        properties:
                          url:
                            type: string
                            description: "TBC."
                            example: "TBC"
                          extension:
                            type: array
                            description: "TBC."
                            items:
                              oneOf:
                                - type: object
                                  description: "TBC."
#                                  required:
#                                    - TBC
                                  properties:
                                    url:
                                      type: string
                                      description: "TBC."
                                      enum:
                                        - "numberOfRepeatPrescriptionsIssued"
                                    valueUnsignedInt:
                                      type: number
                                      description: "TBC."
                                      example: 1
                                - type: object
                                  description: "TBC."
#                                  required:
#                                    - TBC
                                  properties:
                                    url:
                                      type: string
                                      description: "TBC."
                                      enum:
                                        - "authorisationExpiryDate"
                                    valueDateTime:
                                      type: string
                                      description: "TBC."
                                      example: "2020-08-07"
                      - type: object
                        description: "TBC responsible practitioner - 0..1."
#                        required:
#                          - TBC
#                        properties:
                      - type: object
                        description: "TBC prescription endorsement - 0..n."
#                        required:
#                          - TBC
#                        properties:
                      - type: object
                        description: "TBC prescription task reason code - 0..n."
#                        required:
#                          - TBC
#                        properties:
                      - type: object
                        description: "TBC NHS BSA prescription type - 1..1."
                        required:
#                          - url TBC
                          - valueCoding
                        properties:
                          url:
                            type: string
                            description: "TBC."
                            example: "TBC"
                          valueCoding:
                            type: object
                            description: "TBC."
                            required:
                              - TBC
                            properties:
                              system:
                                type: string
                                description: "TBC."
                                example: "TBC"
                              code:
                                type: string
                                description: "TBC."
                                example: "TBC"
                              display:
                                type: string
                                description: "TBC."
                                example: "TBC"
                      - type: object
                        description: "TBC controlled drug - 0..1."
#                        required:
#                          - TBC
#                        properties:
                      - type: object
                        description: "TBC dispending information - 0..1."
#                        required:
#                          - TBC
#                        properties:
                identifier:
                  type: array
                  description: "TBC."
                  items:
                    type: object
                    description: "TBC."
#                    required:
#                      - TBC
#                    properties:
                status:
                  type: string
                  description: "TBC."
                  example: "TBC"
                intent:
                  type: string
                  description: "TBC."
                  example: "TBC"
                category:
                  type: array
                  description: "TBC."
                  items:
                    type: object
                    description: "TBC."
#                    required:
#                      - TBC
#                    properties:
                medicationCodeableConcept:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
                subject:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
                authoredOn:
                  type: string
                  description: "TBC."
                  example: "TBC"
                requestor:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
                groupIdentifier:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
                courseOfTherapyType:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
                dosageInstruction:
                  type: array
                  description: "TBC."
                  items:
                    type: object
                    description: "TBC."
#                    required:
#                      - TBC
#                    properties:
                dispenseRequest:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
                substitution:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
#                  properties:
        - type: object
          description: "The patient for whom the prescription is being ordered. There must be exactly one of these."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:78d3c2eb-009e-4ec8-a358-b042954aa9b2"
            resource:
              type: object
              description: "The FHIR resource for the patient."
              required:
                - ResourceType
#                - TBC what else?
              properties:
                ResourceType:
                  type: string
                  description: The FHIR resource type for the patient.
                  enum:
                    - Patient
                id:
                  type: string
                  description: "A logical identifier for the patient. Optional, and ignored by us."
                  example: "78d3c2eb-009e-4ec8-a358-b042954aa9b2"
#                TBC other properties
        - type: object
          description: "The practitioner ordering, and electronically signing, the prescription. There must be exactly one of these. If this person cannot take responsibility for the prescription - i.e. they would not be the prescriber on the FP10 - then use the `responsiblePractitioner` extension in the `MedicationRequest` resource to specify the responsible practitioner."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:a8c85454-f8cb-498d-9629-78e2cb5fa47a"
            resource:
              type: object
              description: "The FHIR resource for the practitioner."
              required:
                - ResourceType
#                - TBC what else?
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the practitioner."
                  enum:
                    - Practitioner
                id:
                  type: string
                  description: "A logical identifier for the practitioner. Optional, and ignored by us."
                  example: "a8c85454-f8cb-498d-9629-78e2cb5fa47a"
#                TBC other properties
        - type: object
          description: "The role that the practitioner is playing for this prescription order. This also links the practitioner to a specific organisation and, in some cases, a specific healthcare service (clinic or site). There must be exactly one of these."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:56166769-c1c4-4d07-afa8-132b5dfca666"
            resource:
              type: object
              description: "The FHIR resource for the practitioner role."
              required:
                - ResourceType
#                - TBC what else?
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the practitioner role."
                  enum:
                    - PractitionerRole
                id:
                  type: string
                  description: "A logical identifier for the practitioner role. Optional, and ignored by us."
                  example: "56166769-c1c4-4d07-afa8-132b5dfca666"
#                TBC other properties
        - type: object
          description: "The organisaton to which the requesting practitioner belongs for the purposes of this prescription order. There must be exactly one of these."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:3b4b03a5-52ba-4ba6-9b82-70350aa109d8"
            resource:
              type: object
              description: "The FHIR resource for the organisation."
              required:
                - ResourceType
#                - TBC what else?
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the organisation."
                  enum:
                    - Organization
                id:
                  type: string
                  description: "A logical identifier for the organisation. Optional, and ignored by us."
                  example: "3b4b03a5-52ba-4ba6-9b82-70350aa109d8"
#                TBC other properties
        - type: object
          description: "The healthcare service (specific clinic or site) from which the practitioner is ordering the prescription. Not required for GPs, due to their small size. For secondary care prescribing, which are generally larger and more spread out, there must be exactly one of these."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the healthcare service. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:54b0506d-49af-4245-9d40-d7d64902055e"
            resource:
              type: object
              description: "The FHIR resource for the healthcare service."
              required:
                - ResourceType
#                - TBC what else?
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the healthcare service."
                  enum:
                    - HealthcareService
                id:
                  type: string
                  description: "A logical identifier for the healthcare service. Optional, and ignored by us."
                  example: "54b0506d-49af-4245-9d40-d7d64902055e"
                identifier:
                  TBC
                active:
                  TBC
                providedBy:
                  TBC
                location:
                  TBC
                name:
                  TBC
                telecom:
                  TBC
#                TBC other properties
        - type: object
          description: "The location of the healthcare service. If a healthcare service has been specified, there must also be exactly one of these."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "A unique identifier for the resource. Used to refer from one resource to another within the resource bundle."
              example: "urn:uuid:8a5d7d67-64fb-44ec-9802-2dc214bb3dcb"
            resource:
              type: object
              description: "The FHIR resource for the location."
              required:
                - ResourceType
                - address
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the location."
                  enum:
                    - Location
                id:
                  type: string
                  description: "A logical identifier for the location. Optional, and ignored by us."
                  example: "8a5d7d67-64fb-44ec-9802-2dc214bb3dcb"
                identifier:
                  type: array
                  description: "A unique identifier for the location. Ignored by us."
                  example: "[ { \"value\" : \"10008800708\" } ]"
                status:
                  type: string
                  description: "The general availability of the resource. Ignored by us."
                  example: "active"
                mode:
                  type: string
                  description: "Indicates whether a resource instance represents a specific location or a class of locations. Ignored by us."
                  example: "instance"
                address:
                  type: object
                  description: "The postal address of the location."
                  properties:
                    use:
                      type: string
                      description: "Purpose of this address - in this context, likely to be `work`."
                      enum:
                        - work
                        - home
                        - temp
                        - old
                        - billing
                    line:
                      type: array
                      description: "All lines of the address except the city and postal code."
                      example: "[ \"MUSGROVE PARK HOSPITAL\" ]"
                      items:
                        type: string
                    city:
                      type: string
                      description: "City or town for the address."
                      example: "TAUNTON"
                    district:
                      type: string
                      description: "District or county for the address."
                    state:
                      type: string
                      description: "Sub-unit of country for the address."
                    postalCode:
                      type: string
                      description: "Postal code of the address."
                      example: "TA1 5DA"
