type: object
description: The prescription order to be encoded for signing, expressed as a FHIR message 'bundle'.
required:
  - resourceType
  - identifier
  - type
  - entry
properties:
  resourceType:
    type: string
    description: The FHIR resource type for the prescription order bundle.
    enum:
      - Bundle
  id:
    type: string
    description: "A logical identifier for the prescription order bundle. Optional, and ignored by us."
    example: "aef77afb-7e3c-427a-8657-2c427f71a271"
  identifier:
    type: object
    description: "A unique identifier for the prescription order, expressed as a UUID. Used by us to reference the prescription order in various places."
    properties:
      system:
        type: string
        description: "A URL that describes the system or rules used to define the identifier, for example UUID as defined in RFC 4122."
        example: "https://tools.ietf.org/html/rfc4122"
      value:
        type: string
        description: "The identifier itself, generated by you."
        example: "f442b1a3-efe2-4434-b9cf-888e2f12d0a5"
  type:
    type: string
    description: The FHIR bundle type - in this case, a message.
    enum:
      - message
  entry:
    type: array
    description: "The details of the prescription order."
    items:
      oneOf:
        - type: object
          description: "A message header. There must be exactly one of these and it must be first in the array."
          required:
            - fullUrl
            - resource
          properties:
            fullUrl:
              type: string
              description: "TBC."
              example: "urn:uuid:aef77afb-7e3c-427a-8657-2c427f71a271"
            resource:
              type: object
              description: "TBC."
              required:
                - ResourceType
                - eventCoding
                - source
                - focus
              properties:
                ResourceType:
                  type: string
                  description: "The FHIR resource type for the message header."
                  enum:
                    - MessageHeader
                id:
                  type: string
                  description: "TBC."
                  example: "3599c0e9-9292-413e-9270-9a1ef1ead99c"
                eventCoding:
                  type: object
                  description: "The type of event being described in the FHIR message - in this case, a prescription order."
                  required:
                    - system
                    - code
                  properties:
                    system:
                      type: string
                      description: "The code system for the event type."
                      enum:
                        - "https://fhir.nhs.uk/CodeSystem/message-event"
                    code:
                      type: string
                      description: "The actual code for the event type."
                      enum:
                        - "prescription-order"
                    display:
                      type: string
                      description: "A human-readable description of the event type."
                      enum:
                        - "Prescription Order"
                sender:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
                  properties:
                    identifier:
                      type: object
                      description: "TBC."
#                      required:
#                        - TBC
                      properties:
                        system:
                          type: string
                          description: "TBC."
                          example: "https://fhir.nhs.uk/Id/ods-organization-code"
                        value:
                          type: string
                          description: "TBC."
                          example: "RBA"
                    reference:
                      type: string
                      description: "TBC."
                      example: "urn:uuid:56166769-c1c4-4d07-afa8-132b5dfca666"
                    display:
                      type: string
                      description: "TBC."
                      example: "RAZIA|ALI"
                source:
                  type: object
                  description: "TBC."
#                  required:
#                    - TBC
                  properties:
                    endpoint:
                      type: string
                      description: "TBC."
                      example: "urn:nhs-uk:addressing:ods:RBA"
                destination:
                  type: array
                  description: "TBC."
                  items:
                    type: object
                    description: "TBC."
#                    required:
#                      - TBC
                    properties:
                      endpoint:
                        type: string
                        description: "TBC."
                        example: "urn:nhs-uk:addressing:ods:FH542"
                      receiver:
                        type: object
                        description: "TBC."
#                        required:
#                          - TBC
                        properties:
                          identifier:
                            type: object
                            description: "TBC."
#                            required:
#                              - TBC
                            properties:
                              system:
                                type: string
                                description: "TBC."
                                example: "https://fhir.nhs.uk/Id/ods-organization-code"
                              value:
                                type: string
                                description: "TBC."
                                example: "FH542"
                focus:
                  type: array
                  description: "A list of references to the content of the FHIR message i.e the other FHIR resources in the 'items' array."
                  items:
                    type: object
                    description: "A reference to one of the other FHIR resources in the 'items' array."
                    required:
                      - reference
                    properties:
                      reference:
                        type: string
                        description: "The identifier for the FHIR resource being referenced, prefixed with `urn:uuid`."
                        example: "urn:uuid:78d3c2eb-009e-4ec8-a358-b042954aa9b2"
        - type: object
          description: "A medication request. There must be between 1 and 4 of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: The FHIR resource type for the medication request.
              enum:
                - MedicationRequest
            id:
              type: string
              description: "TBC."
              example: "a54219b8-f741-4c47-b662-e4f8dfa49ab6"
            
#            TBC other properties
        - type: object
          description: "The patient for whom the medication is being requested. There must be exactly one of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: The FHIR resource type for the patient.
              enum:
                - Patient
            id:
              type: string
              description: "TBC."
              example: "78d3c2eb-009e-4ec8-a358-b042954aa9b2"
#            TBC other properties
        - type: object
          description: "The practitioner requesting the medication. There must be exactly one of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: "The FHIR resource type for the practitioner."
              enum:
                - Practitioner
            id:
              type: string
              description: "TBC."
              example: "a8c85454-f8cb-498d-9629-78e2cb5fa47a"
#            TBC other properties
        - type: object
          description: "TBC. There must be exactly one of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: "The FHIR resource type for the TBC."
              enum:
                - PractitionerRole
            id:
              type: string
              description: "TBC."
              example: "56166769-c1c4-4d07-afa8-132b5dfca666"
#            TBC other properties
        - type: object
          description: "TBC. There must be exactly one of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: "The FHIR resource type for the organisation."
              enum:
                - Organization
            id:
              type: string
              description: "TBC."
              example: "3b4b03a5-52ba-4ba6-9b82-70350aa109d8"
#            TBC other properties
        - type: object
          description: "TBC. There must be exactly one of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: "The FHIR resource type for the TBC."
              enum:
                - HealthcareService
            id:
              type: string
              description: "TBC."
              example: "54b0506d-49af-4245-9d40-d7d64902055e"
#            TBC other properties
        - type: object
          description: "TBC. There must be exactly one of these."
          required:
            - ResourceType
#            - TBC what else?
          properties:
            ResourceType:
              type: string
              description: "The FHIR resource type for the TBC."
              enum:
                - Location
            id:
              type: string
              description: "TBC."
              example: "8a5d7d67-64fb-44ec-9802-2dc214bb3dcb"
#            TBC other properties

